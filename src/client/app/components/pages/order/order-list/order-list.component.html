<div class="contents-width mx-auto px-3 py-5">
    <h2 class="text-large mb-4 text-center font-weight-bold">注文検索</h2>
    <p class="mb-4">検索してください。</p>
    <div class="conditions p-3 bg-light-gray mb-4">
        <form (submit)="orderSearch(1)">
            <div class="form-row">
                <div class="form-group col-md-4">
                    <label for="orderDateFrom" class="mb-2">購入日（From）</label>
                    <input type="date" class="form-control" name="orderDateFrom" id="orderDateFrom" [(ngModel)]="conditions.orderDateFrom"
                        placeholder="{{ moment().format('YYYY-MM-DD') }}">
                </div>
                <div class="form-group col-md-4">
                    <label for="orderDateThrough" class="mb-2">購入日（Through）</label>
                    <input type="date" class="form-control" name="orderDateThrough" id="orderDateThrough" [(ngModel)]="conditions.orderDateThrough"
                        placeholder="{{ moment().format('YYYY-MM-DD') }}">
                </div>
                <div class="form-group col-md-4">
                    <label for="confirmationNumber" class="mb-2">購入番号</label>
                    <input type="text" class="form-control" name="confirmationNumber" id="confirmationNumber"
                        [(ngModel)]="conditions.confirmationNumber" placeholder="購入番号">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="familyName" class="mb-2">セイ</label>
                    <input type="text" class="form-control" name="familyName" id="familyName" [(ngModel)]="conditions.customer.familyName"
                        placeholder="セイ">
                </div>
                <div class="form-group col-md-6">
                    <label for="givenName" class="mb-2">メイ</label>
                    <input type="text" class="form-control" name="givenName" id="givenName" [(ngModel)]="conditions.customer.givenName"
                        placeholder="メイ">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="email" class="mb-2">メールアドレス</label>
                    <input type="email" class="form-control" name="email" id="email" [(ngModel)]="conditions.customer.email"
                        placeholder="メールアドレス">
                </div>
                <div class="form-group col-md-6">
                    <label for="telephone" class="mb-2">電話番号（下4桁）</label>
                    <input type="telephone" class="form-control" name="telephone" id="telephone" [(ngModel)]="conditions.customer.telephone"
                        placeholder="電話番号">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="orderStatus" class="mb-2">注文ステータス</label>
                    <select class="form-control" name="orderStatus" id="orderStatus" [(ngModel)]="conditions.orderStatuses">
                        <option [value]="''">All</option>
                        <option [value]="orderStatus.OrderCancelled">OrderCancelled</option>
                        <option [value]="orderStatus.OrderDelivered">OrderDelivered</option>
                        <option [value]="orderStatus.OrderPaymentDue">OrderPaymentDue</option>
                        <option [value]="orderStatus.OrderPickupAvailable">OrderPickupAvailable</option>
                        <option [value]="orderStatus.OrderProblem">OrderProblem</option>
                        <option [value]="orderStatus.OrderProcessing">OrderProcessing</option>
                        <option [value]="orderStatus.OrderReturned">OrderReturned</option>
                    </select>
                </div>
            </div>
            <div class="buttons mx-auto">
                <button type="submit" class="btn btn-primary btn-block py-3" [disabled]="isLoading | async">検索する</button>
            </div>
        </form>
    </div>
    <p *ngIf="(order | async).orders.length === 0">予約が見つかりません</p>

    <div *ngIf="(order | async).orders.length > 0">
        <div class="mb-4 text-md-right text-center">
            <ngb-pagination class="d-inline-block" [collectionSize]="(order | async).pageCount * 10" [maxSize]="3" [boundaryLinks]="false"
                (pageChange)="orderSearch($event)"></ngb-pagination>
        </div>
        <ul>
            <li class="text-small align-items-center bg-light-gray item header border-0">
                <div class="p-3"><strong>購入日時</strong></div>
                <div class="p-3"><strong>購入番号</strong></div>
                <div class="p-3"><strong>イベント</strong></div>
                <div class="p-3"><strong>購入者</strong></div>
                <div class="p-3"></div>
            </li>
            <li *ngFor="let order of (order | async).orders" class="text-small align-items-center item border-light-gray mb-3 mb-md-0 p-3 p-md-0">
                <div class="mb-2 d-md-none"><strong>購入日時</strong></div>
                <div class="p-0 p-md-3 mb-3 mb-md-0">{{ moment(order.orderDate).format('YYYY/MM/DD HH:mm') }}</div>
                <div class="mb-2 d-md-none"><strong>購入番号</strong></div>
                <div class="p-0 p-md-3 mb-3 mb-md-0">{{ order.confirmationNumber }}</div>
                <div class="mb-2 d-md-none"><strong>イベント</strong></div>
                <div class="p-0 p-md-3 mb-3 mb-md-0">
                    <div *ngFor="let acceptedOffer of order.acceptedOffers">
                        <p class="mb-2">{{
                            acceptedOffer.itemOffered.reservationFor.name.ja }}</p>
                        <p class="mb-2">{{
                            acceptedOffer.itemOffered.reservationFor.superEvent.location.name.ja }} / {{
                            acceptedOffer.itemOffered.reservationFor.location.name.ja }}</p>
                        <p class="mb-2">{{
                            moment(acceptedOffer.itemOffered.reservationFor.startDate).format('YYYY/MM/DD
                            (ddd) HH:mm') }}</p>
                    </div>
                </div>
                <div class="mb-2 d-md-none"><strong>購入者</strong></div>
                <div class="p-0 p-md-3 mb-3 mb-md-0">
                    <p class="mb-2">{{ order.customer.familyName }} {{ order.customer.givenName }}</p>
                    <p class="mb-2">{{ order.customer.email }}</p>
                    <p class="mb-2">{{ order.customer.telephone | libphonenumberFormat }}</p>
                </div>
                <div class="p-0 p-md-3">
                    <button class="btn btn-block btn-primary py-3 mb-3" (click)="openDetail(order)">詳細</button>
                    <button class="btn btn-block btn-danger py-3" (click)="openAlert({title: '警告', body: '未実装'})">キャンセル</button>
                </div>
            </li>
        </ul>
    </div>
</div>